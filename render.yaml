services:
  - type: web
    name: chatgpt-exporter
    env: python
    plan: free
    buildCommand: |
      apt-get update && apt-get install -y wget unzip curl xvfb libxi6 libgconf-2-4 libnss3-dev libxss1 libappindicator1 libindicator7 fonts-liberation libasound2 libatk1.0-0 libcups2 libgtk-3-0 libxss1 libdbus-glib-1-2
      wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
      dpkg -i google-chrome-stable_current_amd64.deb || true
      apt-get install -f -y
      CHROME_VERSION=$(google-chrome --version | grep -oP '\d+\.\d+\.\d+\.\d+')
      wget https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/$CHROME_VERSION/linux64/chromedriver-linux64.zip
      unzip chromedriver-linux64.zip -d /usr/local/bin/
      apt-get install -y wkhtmltopdf
      pip install -r requirements.txt
    startCommand: streamlit run app.py --server.port=10000 --server.enableCORS=false
